<!DOCTYPE html>
<html>
<head>
  <style>
    #vis.vega-embed {
      width: 100%;
      display: flex;
    }

    #vis.vega-embed details,
    #vis.vega-embed details summary {
      position: relative;
    }
  </style>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/vega@5"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/vega-lite@5.20.1"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
</head>
<body>
  <div id="vis"></div>
  <script>
    (function(vegaEmbed) {
      var spec = {"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}, "background": "#D9E9F0"}, "data": {"name": "data-38941af6d50bada03a173aeb2c67a413"}, "mark": {"type": "bar"}, "encoding": {"color": {"field": "Direction", "scale": {"domain": ["Increase", "Decrease", "Old WACI", "New WACI"], "range": ["red", "green", "#116EA1", "#49A6D9"]}, "type": "ordinal"}, "tooltip": [{"field": "Low", "type": "quantitative"}, {"field": "High", "type": "quantitative"}], "x": {"field": "Attribution", "sort": ["Old WACI", "Model", "Coverage", "Investment", "Divestment", "Weight", "Emissions", "Revenue", "New WACI"], "title": "Attribution Factors", "type": "ordinal"}, "y": {"field": "Low", "scale": {"domain": [152.75, 369.2]}, "title": "WACI", "type": "quantitative"}, "y2": {"field": "High"}}, "title": "WACI Attribution", "$schema": "https://vega.github.io/schema/vega-lite/v5.20.1.json", "datasets": {"data-38941af6d50bada03a173aeb2c67a413": [{"Attribution": "Old WACI", "High": 190.9375, "Low": 152.75, "Value": 190.9375, "Direction": "Old WACI"}, {"Attribution": "Model", "High": 230.9375, "Low": 190.9375, "Value": 40.0, "Direction": "Increase"}, {"Attribution": "Coverage", "High": 282.69546875000003, "Low": 230.93750000000003, "Value": 51.75796875, "Direction": "Increase"}, {"Attribution": "Investment", "High": 274.66796875, "Low": 282.69546875, "Value": -8.0275, "Direction": "Decrease"}, {"Attribution": "Divestment", "High": 301.376953125, "Low": 274.66796875, "Value": 26.708984375, "Direction": "Increase"}, {"Attribution": "Weight", "High": 326.2, "Low": 301.376953125, "Value": 24.823046874999996, "Direction": "Increase"}, {"Attribution": "Emissions", "High": 369.2, "Low": 326.2, "Value": 43.0, "Direction": "Increase"}, {"Attribution": "Revenue", "High": 260.2, "Low": 369.2, "Value": -109.0, "Direction": "Decrease"}, {"Attribution": "New WACI", "High": 260.2, "Low": 152.75, "Value": 260.2, "Direction": "New WACI"}]}};
      var embedOpt = {"mode": "vega-lite"};

      function showError(el, error){
          el.innerHTML = ('<div style="color:red;">'
                          + '<p>JavaScript Error: ' + error.message + '</p>'
                          + "<p>This usually means there's a typo in your chart specification. "
                          + "See the javascript console for the full traceback.</p>"
                          + '</div>');
          throw error;
      }
      const el = document.getElementById('vis');
      vegaEmbed("#vis", spec, embedOpt)
        .catch(error => showError(el, error));
    })(vegaEmbed);

  </script>
</body>
</html>